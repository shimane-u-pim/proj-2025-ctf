# Answer of Q.4

　簡単なパスワードの暗号化Zipの解読です。JohnとHashcatを利用します。

　適当なDebianで`apt install unzip wget hashcat git build-essential`をしておきます。
また、zip2johnはaptでは入らないため、下記のコマンドでビルドします。

```bash
git clone https://github.com/openwall/john.git --depth 1
cd john/src
./configure && make -j 2
sudo make install # 多分不要
```

　このコマンドを実施したディレクトリ（cdを使っているので、ディレクトリが変わりますが、変わる前のディレクトリのことです）から見て、`./john/run`以下にjohnの実行ファイルが生成されます。

　下記コマンドをrunディレクトリ内で実行し、zipのhashを受け取ります。

```bash
./zip2john /path/to/FLAG.zip | cut -d ":" -f 2 > ~/flag.zip.txt
```

　辞書攻撃の種として、Rockyouを用意します。事前に`cd ~`でHOMEに移動してください。

```bash
wget https://github.com/dw0rsec/rockyou.txt/raw/refs/heads/master/rockyou.txt.zip
unzip rockyou.txt.zip
```

　これで、`rockyou.txt`が`~`に出来ました。

　最期に、辞書攻撃を仕掛けます。

```bash
hashcat -m 17210 ~/flag.zip.txt ~/rockyou.txt
```

　少し待つと、`$pkzip$1*1*2*0*3e*32*d`から始まる行が表示されます。最期の`:`より先の`12345678`がパスワードです。

　Zipを解答し、FLAGファイルの中を読んでください。

